<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Histogram</title>
    <script src="../Libraries/d3.min.js" charset="utf-8"></script>
    <script src="../Libraries/crossfilter.min.js"></script>
    <script src="../Libraries/dc.min.js"></script>

    <link href="../CSS/dc.min.css" rel="stylesheet" type="text/css">

</head>
<body>
    <div class="lineGraph"></div>
    <script type="text/javascript">
        // chart dimensions
        var margin = {top:30, right:20, bottom:30, left:50},
            width = 600 - margin.left - margin.right,
            height = 300 - margin.top - margin.bottom;

        // Date parser
        var parseDate = d3.time.format("%Y-%m").parse;
        var lineGraph = dc.lineChart('.lineGraph');

        d3.csv('../data/milk_data.csv', function(error, data){
            // parsing dates and data
            var ndx = crossfilter(data);

            data.forEach(function(d){
                d.date = parseDate(d.date);
                d.data = +d.data;
                d.year = d.date.getFullYear();
            });


            var dateDim = ndx.dimension(function(d){return d.date});
            var milkProd = dateDim.group().reduceSum(function(d){return d.data});

            var minDate = dateDim.bottom(1)[0].date;
            var maxDate = dateDim.top(1)[0].date;

            lineGraph.width(width)
                    .height(height)
                    .dimension(dateDim)
                    .group(milkProd)
                    .x(d3.time.scale().domain([minDate, maxDate]));



            dc.renderAll()


        })

    </script>
</body>
</html>